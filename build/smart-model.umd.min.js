/*! smartModel v0.1.2 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).smartModel={})}(this,(function(e){"use strict";function t(e){return""===e||null==e}function n(e){return"function"==typeof e}function r(e){return Array.isArray(e)}function o(e,n,o){const s=[];if(e.required&&t(o)&&s.push({message:`Invalid type 'required' on property '${n}'`,type:"required",value:o}),e.type){let c;const u=r(e.type)?e.type:[e.type];c=!(e.required||!t(o))||u.some((e=>typeof o==typeof e()||o instanceof e)),c||s.push({message:`Invalid type '${typeof o}' on property '${n}'`,type:"type",value:o,expected:u})}return e.rule&&Object.keys(e.rule).forEach((t=>{const r=e.rule[t];r(o)||s.push({message:`Invalid value '${t}' on property '${n}'`,type:t,value:o,expected:r(o)})})),s}class s extends Error{constructor(e){super(e.message),Object.assign(this,e)}}class c{constructor(e={}){this.schema=e}set(e,t,r){const c=this.schema,f=c[t],i=e[t],p=(a=r,y=i,!(JSON.stringify(a)===JSON.stringify(y)));var a,y;function l(n){return Reflect.apply(n,e,[t,r,i,c])}if(n(f))return!1;if(f.transform&&(r=f.transform(r)),l(e.onBeforeSet),p&&l(e.onBeforeUpdate),u.settings.exeptions){const e=o(f,t,r);e.length&&e.forEach((e=>{throw new s({message:e.message,property:t,type:e.type,value:e.value,expected:e.expected})}))}return e[t]=r,l(e.onSet),p&&l(e.onUpdate),!0}get(e,t){let r=e[t];const o=this.schema,s=o[t];if(e.hasOwnProperty(t))return e[t];if(!s)return e[t];function c(t,n){return Reflect.apply(t,e,n)}return c(e.onBeforeGet,[t,r,o]),n(s)&&(r=c(s,[e])),n(s.format)&&(r=c(s.format,[r,e])),c(e.onGet,[t,r,o]),r}}class u{constructor(e={},t={}){Object.keys(e).forEach((t=>{e[t].default&&(this[t]=e[t].default)})),this.feed(t)}feed(e){Object.keys(e).forEach((t=>{this[t]=e[t]}))}onSet(){}onGet(){}onUpdate(){}onBeforeSet(){}onBeforeGet(){}onBeforeUpdate(){}}u.settings={exceptions:!0},u.create=function(e,t={},n={}){const r={[e]:class extends u{constructor(e){return super(t,e),new Proxy(this,new c(t))}}};return Object.assign(r[e].prototype,n),r[e]},u.throwExeptions=function(e){u.settings.exeptions=e},u.checkErrors=function(e,t){const n={};return Object.keys(e).forEach((r=>{const s=t[r],c=e[r],u=o(c,r,s);"function"!=typeof c&&u.length&&(n[r]=u)})),!!Object.keys(n).length&&n},u.hydrate=function(e,t){return r(t)?t.map((t=>new e(t))):new e(t)},e.default=u,Object.defineProperty(e,"__esModule",{value:!0})}));
