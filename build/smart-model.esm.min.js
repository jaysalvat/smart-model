/*! smartModel v0.1.2 */
function e(e){return""===e||null==e}function t(e){return"function"==typeof e}function r(e){return Array.isArray(e)}function n(t,n,o){const s=[];if(t.required&&e(o)&&s.push({message:`Invalid type 'required' on property '${n}'`,type:"required",value:o}),t.type){let c;const u=r(t.type)?t.type:[t.type];c=!(t.required||!e(o))||u.some((e=>typeof o==typeof e()||o instanceof e)),c||s.push({message:`Invalid type '${typeof o}' on property '${n}'`,type:"type",value:o,expected:u})}return t.rule&&Object.keys(t.rule).forEach((e=>{const r=t.rule[e];r(o)||s.push({message:`Invalid value '${e}' on property '${n}'`,type:e,value:o,expected:r(o)})})),s}class o extends Error{constructor(e){super(e.message),Object.assign(this,e)}}class s{constructor(e={}){this.schema=e}set(e,r,s){const u=this.schema,p=u[r],a=e[r],f=(i=s,y=a,!(JSON.stringify(i)===JSON.stringify(y)));var i,y;function l(t){return Reflect.apply(t,e,[r,s,a,u])}if(t(p))return!1;if(p.transform&&(s=p.transform(s)),l(e.onBeforeSet),f&&l(e.onBeforeUpdate),c.settings.exeptions){const e=n(p,r,s);e.length&&e.forEach((e=>{throw new o({message:e.message,property:r,type:e.type,value:e.value,expected:e.expected})}))}return e[r]=s,l(e.onSet),f&&l(e.onUpdate),!0}get(e,r){let n=e[r];const o=this.schema,s=o[r];if(e.hasOwnProperty(r))return e[r];if(!s)return e[r];function c(t,r){return Reflect.apply(t,e,r)}return c(e.onBeforeGet,[r,n,o]),t(s)&&(n=c(s,[e])),t(s.format)&&(n=c(s.format,[n,e])),c(e.onGet,[r,n,o]),n}}class c{constructor(e={},t={}){Object.keys(e).forEach((t=>{e[t].default&&(this[t]=e[t].default)})),this.feed(t)}feed(e){Object.keys(e).forEach((t=>{this[t]=e[t]}))}onSet(){}onGet(){}onUpdate(){}onBeforeSet(){}onBeforeGet(){}onBeforeUpdate(){}}c.settings={exceptions:!0},c.create=function(e,t={},r={}){const n={[e]:class extends c{constructor(e){return super(t,e),new Proxy(this,new s(t))}}};return Object.assign(n[e].prototype,r),n[e]},c.throwExeptions=function(e){c.settings.exeptions=e},c.checkErrors=function(e,t){const r={};return Object.keys(e).forEach((o=>{const s=t[o],c=e[o],u=n(c,o,s);"function"!=typeof c&&u.length&&(r[o]=u)})),!!Object.keys(r).length&&r},c.hydrate=function(e,t){return r(t)?t.map((t=>new e(t))):new e(t)};export default c;
