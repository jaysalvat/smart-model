/*! SmartModel v0.2.13 */
class e extends Error{constructor(e){super(e.message),Object.assign(this,e)}}function t(e){return void 0===e}function r(e){return""===e||null===e||t(e)}function n(e){return"function"==typeof e}function o(e){return[].concat([],e)}function s(e,t,n){const s=[];return e.required&&r(n)?(s.push({message:`Invalid value 'required' on property '${t}'`,code:"required"}),s):(void 0===n||(!e.type||!e.required&&r(n)||o(e.type).some((e=>function(e,t){return"object"==typeof t&&(t=Object),!function(e){return e.toString().startsWith("class")}(t)&&typeof e==typeof t()||e instanceof t||typeof e==typeof t}(n,e)))||s.push({message:`Invalid type '${typeof n}' on property '${t}'`,code:"type"}),e.rule&&Object.keys(e.rule).forEach((r=>{(0,e.rule[r])(n)&&s.push({message:`Invalid value '${r}' on property '${t}'`,code:r})}))),s)}function c(e={},t,r){if(!e.type)return!1;const n=e.type.prototype instanceof u&&e.type,o="object"==typeof e.type&&e.type;return!(!n&&!o)&&(n||u.create(t.normalize("NFD").replace(/[\u0300-\u036f]/g,"").match(/[a-z]+/gi).map((e=>e.charAt(0).toUpperCase()+e.substr(1).toLowerCase())).join(""),o,r))}class u extends class{constructor(t,r){return new Proxy(this,{set(o,u,i){let a=t[u];const f=o[u],p=(l=i,y=f,!(JSON.stringify(l)===JSON.stringify(y)));var l,y;const d=c(a,u,r);function h(e,r){return Reflect.apply(e,o,r||[u,i,f,t])}if(!a){if(r.strict)return!0;a={}}if(h(o.onBeforeSet),p&&h(o.onBeforeUpdate),n(a.transform)&&(i=h(a.transform,[i,t])),r.exceptions){const t=s(a,u,i);if(t.length)throw new e({message:t[0].message,property:u,code:t[0].code,source:o.constructor.name})}return d&&(i=new d(i instanceof Object?i:{})),o[u]=i,h(o.onSet),p&&h(o.onUpdate),!0},get(e,r){const o=t[r];let s=e[r];if(!o)return e[r];function c(n,o){return Reflect.apply(n,e,o||[r,s,t])}return c(e.onBeforeGet),n(o)&&(s=c(o,[e,t])),n(o.format)&&(s=c(o.format,[s,t])),c(e.onGet),s},deleteProperty(r,n){const o=r[n];function s(e,s){return Reflect.apply(e,r,s||[n,o,t])}if(t[n].required)throw new e({message:`Invalid delete on required propery ${n}`,property:n,code:"required"});return s(r.onBeforeDelete),Reflect.deleteProperty(r,n),s(r.onDelete),s(r.onUpdate),!0}})}}{constructor(e={},r={},n){super(e,n),Object.keys(e).forEach((n=>{t(r[n])&&(e[n].default?this[n]=e[n].default:this[n]=r[n])})),this.feed(r)}feed(e){Object.keys(e).forEach((t=>{this[t]=e[t]}))}onBeforeGet(){}onBeforeSet(){}onBeforeUpdate(){}onDelete(){}onGet(){}onBeforeDelete(){}onSet(){}onUpdate(){}}u.settings={strict:!1,exceptions:!0},u.create=function(e,t,r,n){r=Object.assign({},u.settings,r);const i={[e]:class extends u{constructor(e){super(t,e,r)}}}[e];return i.checkErrors=function(e,n){const u={};return Object.keys(t).forEach((i=>{let a;const f=e[i],p=t[i],l=c(p,i,r);l&&(a=l.checkErrors(f,n));let y=s(p,i,f);a?u[i]=a:y.length&&(n&&(y=y.filter((e=>!o(n).includes(e.code)))),y.length&&(u[i]=y))})),!!Object.keys(u).length&&u},i.hydrate=function(e){return t=e,Array.isArray(t)?e.map((e=>new i(e))):new i(e);var t},Object.assign(i.prototype,n),i.schema=t,i};export default u;
